package datatypes_test

import (
	"math"

	"github.com/ff14wed/xivnet/v3/datatypes"
)

var movementBlockBytes = []byte{
	0x12, 0x12, 0x67, 0x45, 0x01, 0x02, // Direction, U1, U2
	0xAB, 0x89, 0xAB, 0x89, 0xAB, 0x89, // PackedPosition
	0x67, 0x45, 0x00, 0x00, // U3
}

var expectedMovementBlockData = &datatypes.Movement{
	Direction:       0x12,
	HeadRotation:    0x12,
	AnimationType:   0x67,
	AnimationState:  0x45,
	AnimationSpeed:  0x01,
	UnknownRotation: 0x02,
	Position:        datatypes.PackedPosition{X: 0x89AB, Y: 0x89AB, Z: 0x89AB},
	U3:              0x4567,
}

var egressMovementBlockBytes = []byte{
	219, 15, 73, 64, // Direction
	0x67, 0x45, 0x00, 0x00, // U1
	0xAB, 0x89, 0x00, 0x00, // U2
	0, 0, 250, 67, // X
	0, 0, 22, 68, // Y
	0, 0, 47, 68, // Z
}

var expectedEgressMovementBlockData = &datatypes.EgressMovement{
	Direction: math.Pi,
	U1:        0x4567,
	U2:        0x89AB,
	X:         500,
	Y:         600,
	Z:         700,
}

var playSceneBlockBytes = []byte{
	0x15, 0xCD, 0x5B, 0x07, 0x00, 0x00, 0x00, 0x00, // ActorID
	0x01, 0x00, 0x00, 0x00, // EventID
	0x02, 0x00, 0x03, 0x00, // Scene and Pad1
	0x04, 0x00, 0x00, 0x00, // Flags
	0x05, 0x00, 0x00, 0x00, // P1
	0x06, 0x00, 0x00, 0x00, // P2 and Pad2
	0x07, 0x00, 0x00, 0x00, // P3
	0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // P4 and U1

	// PlaySceneData
	0xFF, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
	0xFF, 0x00, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00,
	0x00, 0x01, 0x00, 0x00, 0x00, 0x02, 0x00, 0x00,
	0x00, 0x03, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00,
	0x05, 0x00, 0x00, 0x00, 0x06, 0x00, 0x00, 0x00,
	0xF9, 0xFF, 0xFF, 0xFF, 0x08, 0x00, 0x00, 0x00,
	0x09, 0x00, 0x00, 0x00,

	0x01, 0x00, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00,
	0x03, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00,
	0x05, 0x00, 0x00, 0x00, 0x06, 0x00, 0x00, 0x00,
	0x07, 0x00, 0x00, 0x00, 0x08, 0x00, 0x00, 0x00,
	0x09, 0x00, 0x00, 0x00, 0x0A, 0x00, 0x00, 0x00,
	0x0B, 0x00, 0x00, 0x00, 0x0C, 0x00, 0x00, 0x00,
	0x0D, 0x00, 0x00, 0x00, 0x0E, 0x00, 0x00, 0x00,
	0x0F, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00,
	0x11, 0x00, 0x00, 0x00,
}

var expectedPlaySceneBlockData = &datatypes.DirectorPlayScene{
	EventPlay: datatypes.EventPlay{
		ActorID: 123456789,
		EventID: 1,
		Scene:   2, Pad1: 3,
		Flags: 4, P1: 5, P2: 6, P3: 7, P4: 8, U1: 0,
	},
	Data: datatypes.GenericPlaySceneData([120]byte{
		0xFF, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
		0xFF, 0x00, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00,
		0x00, 0x01, 0x00, 0x00, 0x00, 0x02, 0x00, 0x00,
		0x00, 0x03, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00,
		0x05, 0x00, 0x00, 0x00, 0x06, 0x00, 0x00, 0x00,
		0xF9, 0xFF, 0xFF, 0xFF, 0x08, 0x00, 0x00, 0x00,
		0x09, 0x00, 0x00, 0x00,

		0x01, 0x00, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00,
		0x03, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00,
		0x05, 0x00, 0x00, 0x00, 0x06, 0x00, 0x00, 0x00,
		0x07, 0x00, 0x00, 0x00, 0x08, 0x00, 0x00, 0x00,
		0x09, 0x00, 0x00, 0x00, 0x0A, 0x00, 0x00, 0x00,
		0x0B, 0x00, 0x00, 0x00, 0x0C, 0x00, 0x00, 0x00,
		0x0D, 0x00, 0x00, 0x00, 0x0E, 0x00, 0x00, 0x00,
		0x0F, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00,
		0x11, 0x00, 0x00, 0x00,
	}),
}

var expectedPlaySceneBlockDataJSON = `
{
	"ActorID":123456789,
	"EventID": 1,
	"Scene": 2, "Pad1": 3,
	"Flags": 4, "P1": 5, "P2": 6,
	"Pad2": [0, 0, 0], "P3": 7, "P4": 8, "U1": 0,
	"Data": "ff 00 00 00 01 00 00 00 ff 00 00 00 02 00 00 00 00 01 00 00 00 02 00 00 00 03 00 00 00 04 00 00 05 00 00 00 06 00 00 00 f9 ff ff ff 08 00 00 00 09 00 00 00 01 00 00 00 02 00 00 00 03 00 00 00 04 00 00 00 05 00 00 00 06 00 00 00 07 00 00 00 08 00 00 00 09 00 00 00 0a 00 00 00 0b 00 00 00 0c 00 00 00 0d 00 00 00 0e 00 00 00 0f 00 00 00 10 00 00 00 11 00 00 00"
}`

var expectedCraftState = datatypes.CraftState{
	U1:                255,
	CraftAction:       1,
	U2:                255,
	StepNum:           2,
	Progress:          256,
	ProgressDelta:     512,
	Quality:           768,
	QualityDelta:      1024,
	HQChance:          5,
	Durability:        6,
	DurabilityDelta:   -7,
	CurrentCondition:  8,
	PreviousCondition: 9,
	U6:                [17]uint32{1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17},
}

var expectedCraftStateBlockDataJSON = `
{
	"ActorID":123456789,
	"EventID": 655361,
	"Scene": 2, "Pad1": 3,
	"Flags": 4, "P1": 5, "P2": 6,
	"Pad2": [0, 0, 0], "P3": 7, "P4": 8, "U1": 0,
	"Data": {
		"U1":                255,
		"CraftAction":       1,
		"U2":                255,
		"StepNum":           2,
		"Progress":          256,
		"ProgressDelta":     512,
		"Quality":           768,
		"QualityDelta":      1024,
		"HQChance":          5,
		"Durability":        6,
		"DurabilityDelta":   -7,
		"CurrentCondition":  8,
		"PreviousCondition": 9,
		"U6": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17]
	}
}`
